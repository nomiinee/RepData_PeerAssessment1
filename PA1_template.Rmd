---
title: "PA1_template"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, results = "hide")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

### Loading library and data
```{r, results="hide" }
library("knitr")
library(dplyr)
library(ggplot2)
library(impute)
setwd("C:/Users/Jirawech/Documents/#5assignment1")
mydata<-read.csv("activity.csv", header = TRUE)
```

## What is mean total number of steps taken per day?

1. Process/transform the data for answering the question

```{r, message=FALSE, results = 'hide'}
data1<- mydata %>% group_by(date) %>% summarise(steps=sum(steps, na.rm=TRUE))
data1<-transform(data1, date=strptime(date, format="%Y-%m-%d"))
qplot(data1$steps, geom = 'histogram', bins = 30 )+labs(x= "total number of steps taken each day")
```

## What is the average daily activity pattern?

```{r ,results = 'hide'}
avgPattern<- mydata %>% group_by(interval) %>% summarise(steps=mean(steps, na.rm=TRUE))
ggplot(data = avgPattern, aes(x=interval, y = steps)) + geom_line()+labs(x = "Average steps", y="5 minute interval")
avgPattern[avgPattern$steps == max(avgPattern$steps),]
```
## Imputing missing values
```{r, fig.width=15,fig.height=8}
missingVal <- is.na(mydata$steps)
meanPerDay <- mydata %>% group_by(date) %>% summarise(steps=mean(steps, na.rm=TRUE))
totalMean<-mean(mydata$steps,na.rm=TRUE)
newdata<-mydata
newdata[is.na(newdata)] <- totalMean
newTotal<-newdata %>% group_by(date) %>% summarise(steps=sum(steps, na.rm=TRUE))
ggplot(data= newTotal, aes(x=date,y=steps, fill= as.POSIXlt(date)$wday), width = 30, fill = date )+labs(x= "New total number of steps taken each day")+geom_bar(stat = "identity")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
newmeanPDay<- mean(newTotal$steps)
newmedPDay<- median(newTotal$steps)

```
The overall values are slightly higher because the imputed days that were missing tended to be busier days of the week with more steps.

##Are there differences in activity patterns between weekdays and weekends?
```{r}
fdata<-newdata %>% mutate( weekends.or.weekdays = as.POSIXlt(newdata$date)$wday)
fdata$weekends.or.weekdays<-ifelse(fdata$weekends.or.weekdays %in% c(0,6), 'Weekends', "Weekdays")
result <- aggregate(steps ~ interval+ weekends.or.weekdays , data=fdata, mean)
ggplot(aes(interval, steps),data = result) +facet_grid( weekends.or.weekdays~.)+geom_line()
```
On the Weekends, activity is more sluggish until interval 800, but there is more activity during the day on average.  